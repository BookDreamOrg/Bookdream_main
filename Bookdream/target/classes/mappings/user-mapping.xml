<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="UserDAO"> 

	<resultMap type="user" id="userResult">
		<result property="user_id" column="user_id"/>
		<result property="user_password" column="user_password"/>
		<result property="user_name" column="user_name"/>
		<result property="user_tel" column="user_tel"/>
		<result property="user_level" column="user_level"/>
		<result property="blacklist_yn" column="blacklist_yn"/>
		<result property="flatform_type" column="flatform_type"/>		
		<result property="user_email" column="user_email"/>
	</resultMap>

	<insert id="insertUser">
		insert into users(USER_NO, USER_ID, USER_PASSWORD, USER_NAME, FLATFORM_TYPE, USER_EMAIL) 
		values(user_seq.nextval,#{user_id},#{user_password},#{user_name},'BD',#{user_email})
	</insert>
	
	<select id="idCheck" resultType="int">
		select count(user_id) from users where user_id = #{user_id}
	</select>
	
	<select id="getUser" resultType="user">
			select * 
			from users 
			where user_id=#{user_id} and user_password=#{user_password}
	</select>
	
	<select id="loginCheck" resultType="String">
		select user_name
		from users
		where user_id=#{user_id} and user_password=#{user_password}
	</select>
	
	<!-- 카카오 정보 찾기 -->
	<select id="findKakao" resultType="user">
		select * from users where flatform_type='KAKAO' and user_email=#{user_email}
	</select>
	
	<!-- 네이버 정보 찾기 -->
	<select id="findNaver" parameterType="user" resultType="user">
		select * from users where flatform_type='naver' and user_email=#{user_email}
	</select>
	
	<!-- 구글 정보 찾기 -->
	<select id="findGoogle" parameterType="user" resultType="user">
		select * from users where flatform_type='google' and user_email=#{user_email}
	</select>
	
	<!-- 플랫폼 정보 가져오기ㅡ -->
	<select id="findFlatform" resultType="String">
		select flatform_type from users where user_id=#{user_id} and user_password=#{user_password}
	</select>

	<!--카카오 정보 저장 -->
	<insert id="kakaoInsert" parameterType="java.util.HashMap">
		insert into users(USER_NO, USER_ID, USER_PASSWORD, USER_NAME, USER_TEL, FLATFORM_TYPE, USER_EMAIL) 
		values(user_seq.nextval,'','',#{nickname},'','KAKAO',#{email})
	</insert>
	
		
	<!-- 구글 정보 저장 --> 
	<insert id="googleInsert">
		insert into users(USER_NO, USER_ID, USER_PASSWORD, USER_NAME, USER_TEL, FLATFORM_TYPE, USER_EMAIL)
		values(user_seq.nextval,'','',#{user_name},'',#{flatform_type}, #{user_email})
	</insert>

	
	<!-- 네이버 정보 저장 --> 
	<insert id="naverInsert">
		insert into users(USER_NO, USER_ID, USER_PASSWORD, USER_NAME, USER_TEL, FLATFORM_TYPE, USER_EMAIL)
		values(user_seq.nextval,'','',#{user_name}, #{user_tel}, #{flatform_type}, #{user_email})
	</insert>
	
	
	<!-- 이름 이메일로 아이디 찾기 -->
	<select id="idFind" resultType="String">
		select user_id from users where user_name=#{user_name} and user_email=#{user_email} 
	</select>
	
	<!-- 아이디 이름 이메일로 비밀번호 찾기 -->
	<select id="pwFind" resultType="String">
		select user_password from users where user_id=#{user_id} and user_name=#{user_name} and user_email=#{user_email} 
	</select>
	
</mapper>
